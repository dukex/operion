{
  "id": "crypto-price-tracker",
  "name": "Cryptocurrency Price Tracker",
  "description": "Track multiple cryptocurrency prices and detect significant price movements using CoinGecko API",
  "status": "active",
  "nodes": [
    {
      "id": "crypto-schedule",
      "name": "Crypto Price Schedule Trigger",
      "node_type": "trigger:scheduler",
      "category": "trigger",
      "config": {
        "cron": "*/5 * * * *",
        "timezone": "UTC"
      },
      "enabled": true,
      "provider_id": "scheduler",
      "event_type": "schedule_due",
      "position_x": 50,
      "position_y": 100
    },
    {
      "id": "fetch-crypto-prices",
      "name": "Fetch Crypto Prices",
      "config": {
        "url": "https://api.coingecko.com/api/v3/simple/price?ids={{.variables.crypto_ids}}&vs_currencies=usd&include_24hr_change=true&include_market_cap=true",
        "method": "GET",
        "timeout": 15,
        "headers": {
          "Accept": "application/json",
          "User-Agent": "Operion-CryptoTracker/1.0"
        },
        "retries": {
          "attempts": 3,
          "delay": 2000
        }
      },
      "position_x": 100,
      "position_y": 100,
      "enabled": true,
      "node_type": "httprequest",
      "category": "action"
    },
    {
      "id": "process-bitcoin",
      "name": "Process Bitcoin Data",
      "config": {
        "expression": "{{ $crypto := index .node_results \"fetch-crypto-prices\" }}{{ $btc := $crypto.json.bitcoin }}{ \"coin\": \"bitcoin\", \"price\": {{ $btc.usd }}, \"market_cap\": {{ $btc.usd_market_cap }}, \"change_24h\": {{ $btc.usd_24h_change }}, \"timestamp\": \"{{now}}\", \"significant_change\": {{ if gt (abs $btc.usd_24h_change) .variables.change_threshold }}true{{ else }}false{{ end }}, \"direction\": \"{{ if gt $btc.usd_24h_change 0 }}UP{{ else }}DOWN{{ end }}\" }"
      },
      "position_x": 300,
      "position_y": 50,
      "enabled": true,
      "node_type": "transform",
      "category": "action"
    },
    {
      "id": "process-ethereum",
      "name": "Process Ethereum Data",
      "config": {
        "expression": "{{ $crypto := index .node_results \"fetch-crypto-prices\" }}{{ $eth := $crypto.json.ethereum }}{ \"coin\": \"ethereum\", \"price\": {{ $eth.usd }}, \"market_cap\": {{ $eth.usd_market_cap }}, \"change_24h\": {{ $eth.usd_24h_change }}, \"timestamp\": \"{{now}}\", \"significant_change\": {{ if gt (abs $eth.usd_24h_change) .variables.change_threshold }}true{{ else }}false{{ end }}, \"direction\": \"{{ if gt $eth.usd_24h_change 0 }}UP{{ else }}DOWN{{ end }}\" }"
      },
      "position_x": 300,
      "position_y": 150,
      "enabled": true,
      "node_type": "transform",
      "category": "action"
    },
    {
      "id": "create-summary",
      "name": "Create Price Summary",
      "config": {
        "expression": "{{ $btc := index .node_results \"process-bitcoin\" }}{{ $eth := index .node_results \"process-ethereum\" }}{ \"timestamp\": \"{{now}}\", \"coins\": [ {{ $btc.result }}, {{ $eth.result }} ], \"total_market_cap\": {{ add $btc.result.market_cap $eth.result.market_cap }} }"
      },
      "position_x": 500,
      "position_y": 100,
      "enabled": true,
      "node_type": "transform",
      "category": "action"
    },
    {
      "id": "log-prices",
      "name": "Log Current Prices",
      "config": {
        "message": "{{ $btc := index .node_results \"process-bitcoin\" }}{{ $eth := index .node_results \"process-ethereum\" }}Crypto Prices - BTC: ${{ $btc.result.price }} ({{ $btc.result.change_24h }}%), ETH: ${{ $eth.result.price }} ({{ $eth.result.change_24h }}%)",
        "level": "info"
      },
      "position_x": 700,
      "position_y": 50,
      "enabled": true,
      "node_type": "log",
      "category": "action"
    },
    {
      "id": "send-price-report",
      "name": "Send Price Report",
      "config": {
        "url": "https://httpbin.org/post",
        "method": "POST",
        "headers": {
          "Content-Type": "application/json"
        },
        "body": "{{ $btc := index .node_results \"process-bitcoin\" }}{{ $eth := index .node_results \"process-ethereum\" }}{{ $summary := index .node_results \"create-summary\" }}{ \"service\": \"crypto-tracker\", \"timestamp\": \"{{ $summary.result.timestamp }}\", \"data\": { \"bitcoin\": { \"price\": {{ $btc.result.price }}, \"change_24h\": {{ $btc.result.change_24h }}, \"market_cap\": {{ $btc.result.market_cap }}, \"alert\": {{ $btc.result.significant_change }} }, \"ethereum\": { \"price\": {{ $eth.result.price }}, \"change_24h\": {{ $eth.result.change_24h }}, \"market_cap\": {{ $eth.result.market_cap }}, \"alert\": {{ $eth.result.significant_change }} } }, \"total_market_cap\": {{ $summary.result.total_market_cap }} }",
        "timeout": 10,
        "retries": {
          "attempts": 1,
          "delay": 0
        }
      },
      "position_x": 700,
      "position_y": 150,
      "enabled": true,
      "node_type": "httprequest",
      "category": "action"
    },
    {
      "id": "log-success",
      "name": "Log Success",
      "config": {
        "message": "{{ $summary := index .node_results \"create-summary\" }}Crypto tracking completed successfully for {{ len $summary.result.coins }} coins",
        "level": "info"
      },
      "position_x": 900,
      "position_y": 100,
      "enabled": true,
      "node_type": "log",
      "category": "action"
    },
    {
      "id": "log-fetch-error",
      "name": "Log Fetch Error",
      "config": {
        "message": "Failed to fetch cryptocurrency prices from CoinGecko API",
        "level": "error"
      },
      "position_x": 300,
      "position_y": 250,
      "enabled": true,
      "node_type": "log",
      "category": "action"
    },
    {
      "id": "log-webhook-error",
      "name": "Log Webhook Error",
      "config": {
        "message": "Failed to send crypto price report",
        "level": "error"
      },
      "position_x": 700,
      "position_y": 250,
      "enabled": true,
      "node_type": "log",
      "category": "action"
    }
  ],
  "connections": [
    {
      "id": "trigger-crypto-schedule-to-fetch-crypto-prices",
      "source_port": "crypto-schedule:success",
      "target_port": "fetch-crypto-prices:main"
    },
    {
      "id": "fetch-to-bitcoin",
      "source_port": "fetch-crypto-prices:success",
      "target_port": "process-bitcoin:main"
    },
    {
      "id": "fetch-to-ethereum",
      "source_port": "fetch-crypto-prices:success",
      "target_port": "process-ethereum:main"
    },
    {
      "id": "bitcoin-to-summary",
      "source_port": "process-bitcoin:success",
      "target_port": "create-summary:main"
    },
    {
      "id": "ethereum-to-summary",
      "source_port": "process-ethereum:success",
      "target_port": "create-summary:main"
    },
    {
      "id": "summary-to-log",
      "source_port": "create-summary:success",
      "target_port": "log-prices:main"
    },
    {
      "id": "log-to-webhook",
      "source_port": "log-prices:success",
      "target_port": "send-price-report:main"
    },
    {
      "id": "webhook-to-success",
      "source_port": "send-price-report:success",
      "target_port": "log-success:main"
    },
    {
      "id": "fetch-error",
      "source_port": "fetch-crypto-prices:error",
      "target_port": "log-fetch-error:main"
    },
    {
      "id": "webhook-error",
      "source_port": "send-price-report:error",
      "target_port": "log-webhook-error:main"
    }
  ],
  "variables": {
    "crypto_ids": "bitcoin,ethereum",
    "change_threshold": 5.0
  },
  "metadata": {
    "version": "1.0",
    "author": "Operion",
    "tags": [
      "cryptocurrency",
      "bitcoin",
      "ethereum",
      "coingecko",
      "real-api"
    ],
    "description": "Real cryptocurrency price tracking using CoinGecko's free API. No API key required.",
    "api_requirements": {
      "coingecko": "Free API - no key required. Rate limit: 10-30 requests/minute"
    }
  }
}